<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Street Sweeper 13 — Credits</title>
  <link rel="icon" href="icon.png" sizes="any" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #0b0f14;
      --fg: #eaeaea;
      --muted: #a0a6ad;
      --accent: #00d18f;
      --panel: rgba(0,0,0,0.25);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; background: var(--bg); color: var(--fg);
      display: grid; place-items: center; font-family: 'Press Start 2P', monospace, system-ui;
    }
    .wrap { width: min(720px, 92vw); padding: 16px; }
    .panel {
      background: var(--panel);
      border: 1px solid #22303c;
      box-shadow: 0 0 0 2px #000 inset, 0 6px 0 0 #0d1218, 0 6px 0 2px #000;
      padding: 16px;
    }
    h1, h2, h3 { margin: 12px 0; line-height: 1.3; }
    h1 { font-size: 18px; }
    h2 { font-size: 14px; color: var(--accent); }
    p { margin: 12px 0; color: var(--muted); font-size: 12px; line-height: 1.6; }
    ul { margin: 8px 0 16px 18px; font-size: 12px; }
    a { color: #9ae6b4; text-decoration: none; }
    a:hover { text-decoration: underline; }

  .pixel-btn { position: relative; appearance: none; border: none; background: #1e2936; color: #eaeaea; font-size: 14px; padding: 12px 16px; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 0 0 2px #000 inset, 0 0 0 1px #2c3642, 0 4px 0 0 #0d1218, 0 4px 0 2px #000; }
    .pixel-btn:hover { filter: brightness(1.08); }
    .pixel-btn:active { transform: translateY(2px); box-shadow: 0 0 0 2px #000 inset, 0 0 0 1px #2c3642, 0 2px 0 0 #0d1218, 0 2px 0 2px #000; }
  .pixel-btn.primary { background: #0f6a52; }
    .topbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
    .title { font-size: 14px; }
  .lang-switch { display: flex; gap: 8px; align-items: center; }
    .muted { color: var(--muted); font-size: 11px; }
    .spacer { height: 8px; }
    .grid { display: grid; gap: 12px; }

  /* Language visibility */
  .i18n { display: none; }
  body[data-lang="en"] .i18n.en { display: block; }
  body[data-lang="fr"] .i18n.fr { display: block; }

    @media (max-width: 480px) {
      h1 { font-size: 16px; }
      .title { font-size: 12px; }
      .pixel-btn { font-size: 12px; padding: 10px 14px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="title" id="page-title">Street Sweeper 13 — Credits</div>
      <div class="lang-switch">
        <a id="back-btn" class="pixel-btn" href="index.html">Back</a>
      </div>
    </div>
    <div class="muted" style="margin-bottom:8px;" id="version-line">v13.0.0</div>
    <div id="credits-root"><!-- injected language panel --></div>
  </div>
  <script src="i18n/i18n.js"></script>
  <script>
    // Dynamic credits loader: loads HTML fragment per language for maintainability.
      // Maintenance Guide:
      // 1. Per-language fragments live in i18n/credits/<lang>.html where <lang> matches SS13_I18N.LANGS code.
      // 2. To update content, edit every fragment; keep section order & basic structure.
      // 3. To add a new language:
      //    - Add flag & strings to i18n/i18n.js (LANGS + any needed STRINGS keys for chrome labels).
      //    - Create i18n/credits/<new>.html (can copy en.html as a base).
      //    - No JS changes needed unless you want a localized page title; then add it to titles{} below.
      // 4. Fallback: if a fragment fetch fails, we try English then show an inline error.
    (function(){
      const AVAILABLE = (window.SS13_I18N && window.SS13_I18N.LANGS.map(l=>l.code)) || ['en','fr'];
      const KEY = 'ss13_lang';
      function pickLang(){
        let lang = null;
        try { lang = localStorage.getItem(KEY); } catch {}
        if (!lang) lang = (navigator.language || navigator.userLanguage || 'en');
        // Normalize
        if (AVAILABLE.includes(lang)) return lang;
        const base = lang.split('-')[0];
        // prefer full matches (e.g. pt-BR), then base code fallback
        const full = AVAILABLE.find(l=>l.toLowerCase()===lang.toLowerCase());
        if (full) return full;
        const baseMatch = AVAILABLE.find(l=>l.split('-')[0] === base);
        if (baseMatch) return baseMatch;
        return 'en';
      }
      const lang = pickLang();
      document.documentElement.setAttribute('lang', lang);
      // Helper to localize small UI bits using existing game strings
      function localizeChrome(){
        const back = document.getElementById('back-btn');
        if (back && window.SS13_I18N) {
          back.textContent = window.SS13_I18N.getString('game_over_back_button', lang);
          back.setAttribute('aria-label', back.textContent);
        }
        const titles = {
          en: 'Street Sweeper 13 — Credits',
          fr: 'Street Sweeper 13 — Crédits',
          'pt-BR': 'Street Sweeper 13 — Créditos',
          es: 'Street Sweeper 13 — Créditos',
          pl: 'Street Sweeper 13 — Autorzy',
          no: 'Street Sweeper 13 — Bidragsytere',
          de: 'Street Sweeper 13 — Mitwirkende'
        };
        const titleText = titles[lang] || titles.en;
        const titleEl = document.getElementById('page-title');
        if (titleEl) titleEl.textContent = titleText;
        document.title = titleText;
      }
      localizeChrome();
      // Load fragment
      const root = document.getElementById('credits-root');
      const fragmentPath = `i18n/credits/${lang}.html`;
      function load(path){
        return fetch(path).then(r=> r.ok ? r.text() : Promise.reject(r.status));
      }
      load(fragmentPath).catch(()=>load('i18n/credits/en.html')).then(html=>{
        if (root) root.innerHTML = html;
      }).catch(err=>{
        if (root) root.innerHTML = `<div class="panel"><p style="color:#f88">Failed to load credits (${err}).</p></div>`;
      });
    })();
  </script>
</body>
</html>
